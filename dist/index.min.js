!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("aws-sdk"),function(){try{return require("crypto")}catch(e){}}()):"function"==typeof define&&define.amd?define(["aws-sdk","crypto"],t):"object"==typeof exports?exports.luno=t(require("aws-sdk"),function(){try{return require("crypto")}catch(e){}}()):e.luno=t(e["aws-sdk"],e.crypto)}(this,function(e,t){return function(e){function t(r){if(n[r])return n[r].exports;var a=n[r]={exports:{},id:r,loaded:!1};return e[r].call(a.exports,a,a.exports,t),a.loaded=!0,a.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}Object.defineProperty(t,"__esModule",{value:!0}),t.botkit=t.db=void 0;var a=n(1),u=r(a),o=n(11),i=r(o);t.db=u,t.botkit=i},function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}Object.defineProperty(t,"__esModule",{value:!0}),t.token=t.answer=t.bot=t.user=t.team=t.client=void 0;var a=n(2),u=r(a),o=n(4),i=r(o),c=n(5),s=r(c),f=n(8),d=r(f),l=n(9),p=r(l),v=n(10),m=r(v);t.client=u,t.team=i,t.user=s,t.bot=d,t.answer=p,t.token=m},function(e,t,n){"use strict";function r(e){var t=process,n=t.env.STAGE;return n+"-"+e}function a(e,t){var n=new e;return Object.assign(n,t)}function u(){for(var e=arguments.length,t=Array(e),n=0;e>n;n++)t[n]=arguments[n];return t.join("_")}function o(e){return e.split("_")}Object.defineProperty(t,"__esModule",{value:!0}),t.resolveTableName=r,t.fromDB=a,t.compositeId=u,t.deconstructId=o,t["default"]=function(){var e=n(3),t=e.DynamoDB.DocumentClient;return new t}()},function(t,n){t.exports=e},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e){var t={TableName:f,Key:{id:e}};return new Promise(function(e,n){s["default"].get(t,function(t,r){if(t)return n(t);var a=void 0;return r.Item&&(a=(0,c.fromDB)(d,r.Item)),e(a)})})}function o(e){e.bot.userId=e.bot.user_id,delete e.bot.user_id;var t=(new Date).toISOString(),n={TableName:f,Key:{id:e.id},UpdateExpression:"\n      SET\n        #createdBy = if_not_exists(createdBy, :createdBy),\n        #name = :name,\n        #slack = :slack,\n        #created = if_not_exists(#created, :created),\n        #changed = :changed\n    ",ExpressionAttributeNames:{"#createdBy":"createdBy","#name":"name","#slack":"slack","#created":"created","#changed":"changed"},ExpressionAttributeValues:{":createdBy":e.createdBy,":name":e.name,":slack":{bot:e.bot,url:e.url,token:e.token},":created":t,":changed":t},ReturnValues:"ALL_NEW"};return new Promise(function(e,t){s["default"].update(n,function(n,r){if(n)return t(n);var a=(0,c.fromDB)(d,r.Attributes);return e(a)})})}function i(){var e={TableName:f};return new Promise(function(t,n){s["default"].query(e,function(e,r){return e?n(e):t(r.Items.map(function(e){return(0,c.fromDB)(d,e)}))})})}Object.defineProperty(t,"__esModule",{value:!0}),t.Team=void 0,t.getTeam=u,t.updateTeam=o,t.getTeams=i;var c=n(2),s=r(c),f=(0,c.resolveTableName)("team-v1"),d=t.Team=function l(){a(this,l)}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e){return new Promise(function(t,n){var r={TableName:f,Key:{id:e}};s["default"].get(r,function(e,r){if(e)return n(e);var a=void 0;return r.Item&&(a=(0,c.fromDB)(d,r.Item)),t(a)})})}function o(e){var t=(new Date).toISOString(),n={TableName:f,Key:{id:e.id},UpdateExpression:"\n      SET\n        #accessToken = :accessToken,\n        #scopes = :scopes,\n        #teamId = :teamId,\n        #user = :user,\n        #created = if_not_exists(#created, :created),\n        #changed = :changed\n    ",ExpressionAttributeNames:{"#accessToken":"accessToken","#scopes":"scopes","#teamId":"teamId","#user":"user","#created":"created","#changed":"changed"},ExpressionAttributeValues:{":accessToken":e.accessToken,":scopes":e.scopes,":teamId":e.teamId,":user":e.user,":created":t,":changed":t},ReturnValues:"ALL_NEW"};return new Promise(function(t,r){s["default"].update(n,function(n,a){return n?r(n):(e=(0,c.fromDB)(d,a.Attributes),t(e))})})}Object.defineProperty(t,"__esModule",{value:!0}),t.User=void 0,t.getUser=u,t.updateUser=o;var i=n(6),c=(r(i),n(2)),s=r(c),f=(0,c.resolveTableName)("user-v1"),d=t.User=function l(){a(this,l)}},function(e,t,n){var r;!function(a){"use strict";function u(){var e=a.crypto||a.msCrypto;if(!d&&e&&e.getRandomValues)try{var t=new Uint8Array(16);v=d=function(){return e.getRandomValues(t),t},d()}catch(n){}if(!d){var r=new Array(16);l=d=function(){for(var e,t=0;16>t;t++)0===(3&t)&&(e=4294967296*Math.random()),r[t]=e>>>((3&t)<<3)&255;return r},"undefined"!=typeof console&&console.warn&&console.warn("[SECURITY] node-uuid: crypto not usable, falling back to insecure Math.random()")}}function o(){try{var e=n(7).randomBytes;p=d=e&&function(){return e(16)},d()}catch(t){}}function i(e,t,n){var r=t&&n||0,a=0;for(t=t||[],e.toLowerCase().replace(/[0-9a-f]{2}/g,function(e){16>a&&(t[r+a++]=w[e])});16>a;)t[r+a++]=0;return t}function c(e,t){var n=t||0,r=b;return r[e[n++]]+r[e[n++]]+r[e[n++]]+r[e[n++]]+"-"+r[e[n++]]+r[e[n++]]+"-"+r[e[n++]]+r[e[n++]]+"-"+r[e[n++]]+r[e[n++]]+"-"+r[e[n++]]+r[e[n++]]+r[e[n++]]+r[e[n++]]+r[e[n++]]+r[e[n++]]}function s(e,t,n){var r=t&&n||0,a=t||[];e=e||{};var u=null!=e.clockseq?e.clockseq:_,o=null!=e.msecs?e.msecs:(new Date).getTime(),i=null!=e.nsecs?e.nsecs:x+1,s=o-T+(i-x)/1e4;if(0>s&&null==e.clockseq&&(u=u+1&16383),(0>s||o>T)&&null==e.nsecs&&(i=0),i>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");T=o,x=i,_=u,o+=122192928e5;var f=(1e4*(268435455&o)+i)%4294967296;a[r++]=f>>>24&255,a[r++]=f>>>16&255,a[r++]=f>>>8&255,a[r++]=255&f;var d=o/4294967296*1e4&268435455;a[r++]=d>>>8&255,a[r++]=255&d,a[r++]=d>>>24&15|16,a[r++]=d>>>16&255,a[r++]=u>>>8|128,a[r++]=255&u;for(var l=e.node||h,p=0;6>p;p++)a[r+p]=l[p];return t?t:c(a)}function f(e,t,n){var r=t&&n||0;"string"==typeof e&&(t="binary"===e?new m(16):null,e=null),e=e||{};var a=e.random||(e.rng||d)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t)for(var u=0;16>u;u++)t[r+u]=a[u];return t||c(a)}var d,l,p,v;a?u():o();for(var m="function"==typeof Buffer?Buffer:Array,b=[],w={},y=0;256>y;y++)b[y]=(y+256).toString(16).substr(1),w[b[y]]=y;var g=d(),h=[1|g[0],g[1],g[2],g[3],g[4],g[5]],_=16383&(g[6]<<8|g[7]),T=0,x=0,I=f;I.v1=s,I.v4=f,I.parse=i,I.unparse=c,I.BufferClass=m,I._rng=d,I._mathRNG=l,I._nodeRNG=p,I._whatwgRNG=v,"undefined"!=typeof e&&e.exports?e.exports=I:(r=function(){return I}.call(t,n,t,e),!(void 0!==r&&(e.exports=r)))}("undefined"!=typeof window?window:null)},function(e,t){e.exports=require("crypto")},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e){var t=new p,n=(new Date).toISOString();Object.assign(t,e),t.id=s["default"].v4(),t.created=n,t.changed=n;var r={TableName:l,Item:t};return new Promise(function(e,n){d["default"].put(r,function(r,a){return r?n(r):e(t)})})}function o(e,t){return new Promise(function(n,r){var a={TableName:l,Key:{teamId:e,id:t}};d["default"].get(a,function(e,t){if(e)return r(e);var a=(0,f.fromDB)(p,t.Item);return n(a)})})}function i(e){return new Promise(function(t,n){var r={TableName:l,KeyConditionExpression:"teamId = :teamId",ExpressionAttributeValues:{":teamId":e}};d["default"].query(r,function(e,r){return e?n(e):t(r.Items.map(function(e){return(0,f.fromDB)(p,e)}))})})}Object.defineProperty(t,"__esModule",{value:!0}),t.Bot=void 0,t.createBot=u,t.getBot=o,t.getBots=i;var c=n(6),s=r(c),f=n(2),d=r(f),l=(0,f.resolveTableName)("bot-v1"),p=t.Bot=function v(){a(this,v)}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e){var t=e.botId,n=a(e,["botId"]),r=new b;Object.assign(r,n),r.id=l["default"].v4(),r.botId=t,now=(new Date).toISOString(),r.created=now,r.changed=now;var u={TableName:m,Item:r};return new Promise(function(e,t){v["default"].put(u,function(n,a){return n?t(n):e(r)})})}function i(e,t){var n={TableName:m,Key:{id:t,botId:e}};return new Promise(function(e,t){v["default"].get(n,function(n,r){if(n)return t(n);var a=void 0;return r.Item&&(a=(0,p.fromDB)(b,r.Item)),e(a)})})}function c(e){var t={TableName:m,KeyConditionExpression:"botId = :botId",ExpressionAttributeValues:{":botId":e}};return new Promise(function(e,n){v["default"].query(t,function(t,r){return t?n(t):e(r.Items.map(function(e){return(0,p.fromDB)(b,e)}))})})}function s(e,t){var n={TableName:m,Key:{id:t,botId:e},ReturnValues:"ALL_OLD"};return new Promise(function(e,t){v["default"]["delete"](n,function(n,r){return n?t(n):e((0,p.fromDB)(b,r.Attributes))})})}function f(e){var t=e.botId,n=e.id,r=e.title,a=e.body,u={TableName:m,Key:{id:n,botId:t},UpdateExpression:"\n      SET\n        #title = :title,\n        #body = :body,\n        #changed = :changed\n    ",ExpressionAttributeNames:{"#title":"title","#body":"body","#changed":"changed"},ExpressionAttributeValues:{":title":r,":body":a,":changed":(new Date).toISOString()},ReturnValues:"ALL_NEW"};return new Promise(function(e,t){v["default"].update(u,function(n,r){return n?t(n):e((0,p.fromDB)(b,r.Attributes))})})}Object.defineProperty(t,"__esModule",{value:!0}),t.Answer=void 0,t.createAnswer=o,t.getAnswer=i,t.getAnswers=c,t.deleteAnswer=s,t.updateAnswer=f;var d=n(6),l=r(d),p=n(2),v=r(p),m=(0,p.resolveTableName)("answer-v1"),b=t.Answer=function w(){u(this,w)}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){var n={TableName:p,Key:{id:t,userId:e}};return new Promise(function(e,t){l["default"].get(n,function(n,r){if(n)return t(n);var a=void 0;return r.Item&&(a=(0,d.fromDB)(v,r.Item)),e(a)})})}function i(e){var t=e.userId,n=a(e,["userId"]),r=new v,u=(new Date).toISOString();Object.assign(r,n),r.id=f["default"].v4(),r.userId=t,r.active=!0,r.created=u,r.changed=u;var o={TableName:p,Item:r};return new Promise(function(e,t){l["default"].put(o,function(n,a){return n?t(n):e(r)})})}function c(e,t){var n={TableName:p,Key:{id:e,userId:t}};return new Promise(function(e,t){l["default"]["delete"](n,function(n,r){return n?t(n):e()})})}Object.defineProperty(t,"__esModule",{value:!0}),t.Token=void 0,t.getToken=o,t.createToken=i,t.deleteToken=c;var s=n(6),f=r(s),d=n(2),l=r(d),p=(0,d.resolveTableName)("token-v1"),v=t.Token=function m(){u(this,m)}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(12);Object.defineProperty(t,"storage",{enumerable:!0,get:function(){return r(a)["default"]}})},function(e,t,n){"use strict";function r(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function r(a,u){try{var o=t[a](u),i=o.value}catch(c){return void n(c)}return o.done?void e(i):Promise.resolve(i).then(function(e){return r("next",e)},function(e){return r("throw",e)})}return r("next")})}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(4),u=n(5),o=n(8);t["default"]={teams:{get:function(){var e=r(regeneratorRuntime.mark(function t(e,n){var r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=void 0,t.prev=1,t.next=4,(0,a.getTeam)(e);case 4:r=t.sent,t.next=10;break;case 7:return t.prev=7,t.t0=t["catch"](1),t.abrupt("return",n(t.t0));case 10:return t.abrupt("return",n(null,r));case 11:case"end":return t.stop()}},t,void 0,[[1,7]])}));return function(t,n){return e.apply(this,arguments)}}(),save:function(){var e=r(regeneratorRuntime.mark(function t(e,n){var r,u=e.team,i=e.isnew;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=void 0,e.prev=1,e.next=4,(0,a.updateTeam)(u);case 4:r=e.sent,e.next=10;break;case 7:return e.prev=7,e.t0=e["catch"](1),e.abrupt("return",n(e.t0));case 10:if(!i){e.next=19;break}return e.prev=11,e.next=14,(0,o.createBot)({teamId:r.id});case 14:e.next=19;break;case 16:return e.prev=16,e.t1=e["catch"](11),e.abrupt("return",n(e.t1));case 19:return e.abrupt("return",n(null,r));case 20:case"end":return e.stop()}},t,void 0,[[1,7],[11,16]])}));return function(t,n){return e.apply(this,arguments)}}(),all:function(){var e=r(regeneratorRuntime.mark(function t(e){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=void 0,t.prev=1,t.next=4,(0,a.getTeams)();case 4:n=t.sent,t.next=10;break;case 7:return t.prev=7,t.t0=t["catch"](1),t.abrupt("return",e(t.t0));case 10:return t.abrupt("return",e(null,n));case 11:case"end":return t.stop()}},t,void 0,[[1,7]])}));return function(t){return e.apply(this,arguments)}}()},users:{get:function(){var e=r(regeneratorRuntime.mark(function t(e,n){var r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=void 0,t.prev=1,t.next=4,(0,u.getUser)(e);case 4:r=t.sent,t.next=10;break;case 7:return t.prev=7,t.t0=t["catch"](1),t.abrupt("return",n(t.t0));case 10:return t.abrupt("return",n(null,r));case 11:case"end":return t.stop()}},t,void 0,[[1,7]])}));return function(t,n){return e.apply(this,arguments)}}(),save:function(){var e=r(regeneratorRuntime.mark(function t(e,n){var r,a=e.user;e.isnew;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a.access_token&&(a.accessToken=a.access_token,delete a.access_token),a.team_id&&(a.teamId=a.team_id,delete a.team_id),r=void 0,e.prev=3,e.next=6,(0,u.updateUser)(a);case 6:r=e.sent,e.next=12;break;case 9:return e.prev=9,e.t0=e["catch"](3),e.abrupt("return",n(e.t0));case 12:return e.abrupt("return",n(null,r));case 13:case"end":return e.stop()}},t,void 0,[[3,9]])}));return function(t,n){return e.apply(this,arguments)}}(),all:function(e){return e(new Error("Not implemented"))}},channels:{get:function(e,t){return t(new Error("Not implemented"))},save:function(e,t){return t(new Error("Not implemented"))},all:function(e){return e(new Error("Not implemented"))}}}}])});
//# sourceMappingURL=index.min.js.map
