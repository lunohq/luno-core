!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("aws-sdk"),function(){try{return require("crypto")}catch(e){}}()):"function"==typeof define&&define.amd?define(["aws-sdk","crypto"],t):"object"==typeof exports?exports.luno=t(require("aws-sdk"),function(){try{return require("crypto")}catch(e){}}()):e.luno=t(e["aws-sdk"],e.crypto)}(this,function(e,t){return function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}Object.defineProperty(t,"__esModule",{value:!0}),t.botkit=t.db=void 0;var o=n(1),a=r(o),u=n(11),i=r(u);t.db=a,t.botkit=i},function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}Object.defineProperty(t,"__esModule",{value:!0}),t.token=t.answer=t.bot=t.user=t.team=t.client=void 0;var o=n(2),a=r(o),u=n(4),i=r(u),c=n(5),s=r(c),f=n(8),d=r(f),l=n(9),p=r(l),v=n(10),m=r(v);t.client=a,t.team=i,t.user=s,t.bot=d,t.answer=p,t.token=m},function(e,t,n){"use strict";function r(e){var t=process,n=t.env.STAGE;return n+"-"+e}function o(e,t){var n=new e;return Object.assign(n,t)}function a(){for(var e=arguments.length,t=Array(e),n=0;e>n;n++)t[n]=arguments[n];return t.join("_")}function u(e){return e.split("_")}Object.defineProperty(t,"__esModule",{value:!0}),t.resolveTableName=r,t.fromDB=o,t.compositeId=a,t.deconstructId=u,t["default"]=function(){var e=n(3),t=e.DynamoDB.DocumentClient;return new t}()},function(t,n){t.exports=e},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e){var t={TableName:f,Key:{id:e}};return new Promise(function(e,n){s["default"].get(t,function(t,r){if(t)return n(t);var o=void 0;return r.Item&&(o=(0,c.fromDB)(d,r.Item)),e(o)})})}function u(e){e.bot.userId=e.bot.user_id,delete e.bot.user_id;var t=(new Date).toISOString(),n={TableName:f,Key:{id:e.id},UpdateExpression:"\n      SET\n        #createdBy = if_not_exists(createdBy, :createdBy),\n        #name = :name,\n        #slack = :slack,\n        #created = if_not_exists(#created, :created),\n        #changed = :changed\n    ",ExpressionAttributeNames:{"#createdBy":"createdBy","#name":"name","#slack":"slack","#created":"created","#changed":"changed"},ExpressionAttributeValues:{":createdBy":e.createdBy,":name":e.name,":slack":{bot:e.bot,url:e.url,token:e.token},":created":t,":changed":t},ReturnValues:"ALL_NEW"};return new Promise(function(e,t){s["default"].update(n,function(n,r){if(n)return t(n);var o=(0,c.fromDB)(d,r.Attributes);return e(o)})})}function i(){var e={TableName:f};return new Promise(function(t,n){s["default"].query(e,function(e,r){return e?n(e):t(r.Items.map(function(e){return(0,c.fromDB)(d,e)}))})})}Object.defineProperty(t,"__esModule",{value:!0}),t.Team=void 0,t.getTeam=a,t.updateTeam=u,t.getTeams=i;var c=n(2),s=r(c),f=(0,c.resolveTableName)("team-v1"),d=t.Team=function l(){o(this,l)}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e){return new Promise(function(t,n){var r={TableName:l,Key:{id:e}};d["default"].get(r,function(e,r){if(e)return n(e);var o=void 0;return r.Item&&(o=(0,f.fromDB)(p,r.Item)),t(o)})})}function c(e){var t=(new Date).toISOString(),n={TableName:l,Key:{id:e.id},UpdateExpression:"\n      SET\n        #accessToken = :accessToken,\n        #scopes = :scopes,\n        #teamId = :teamId,\n        #user = :user,\n        #created = if_not_exists(#created, :created),\n        #changed = :changed\n    ",ExpressionAttributeNames:{"#accessToken":"accessToken","#scopes":"scopes","#teamId":"teamId","#user":"user","#created":"created","#changed":"changed"},ExpressionAttributeValues:{":accessToken":e.accessToken,":scopes":e.scopes,":teamId":e.teamId,":user":e.user,":created":t,":changed":t},ReturnValues:"ALL_NEW"};return new Promise(function(t,r){d["default"].update(n,function(n,o){return n?r(n):(e=(0,f.fromDB)(p,o.Attributes),t(e))})})}Object.defineProperty(t,"__esModule",{value:!0}),t.AnonymousUser=t.User=void 0,t.getUser=i,t.updateUser=c;var s=n(6),f=(r(s),n(2)),d=r(f),l=(0,f.resolveTableName)("user-v1"),p=t.User=function v(){u(this,v),this.anonymous=!1};t.AnonymousUser=function(e){function t(){var e,n,r,a;u(this,t);for(var i=arguments.length,c=Array(i),s=0;i>s;s++)c[s]=arguments[s];return n=r=o(this,(e=Object.getPrototypeOf(t)).call.apply(e,[this].concat(c))),r.anonymous=!0,a=n,o(r,a)}return a(t,e),t}(p)},function(e,t,n){var r;!function(o){"use strict";function a(){var e=o.crypto||o.msCrypto;if(!d&&e&&e.getRandomValues)try{var t=new Uint8Array(16);v=d=function(){return e.getRandomValues(t),t},d()}catch(n){}if(!d){var r=new Array(16);l=d=function(){for(var e,t=0;16>t;t++)0===(3&t)&&(e=4294967296*Math.random()),r[t]=e>>>((3&t)<<3)&255;return r},"undefined"!=typeof console&&console.warn&&console.warn("[SECURITY] node-uuid: crypto not usable, falling back to insecure Math.random()")}}function u(){try{var e=n(7).randomBytes;p=d=e&&function(){return e(16)},d()}catch(t){}}function i(e,t,n){var r=t&&n||0,o=0;for(t=t||[],e.toLowerCase().replace(/[0-9a-f]{2}/g,function(e){16>o&&(t[r+o++]=y[e])});16>o;)t[r+o++]=0;return t}function c(e,t){var n=t||0,r=b;return r[e[n++]]+r[e[n++]]+r[e[n++]]+r[e[n++]]+"-"+r[e[n++]]+r[e[n++]]+"-"+r[e[n++]]+r[e[n++]]+"-"+r[e[n++]]+r[e[n++]]+"-"+r[e[n++]]+r[e[n++]]+r[e[n++]]+r[e[n++]]+r[e[n++]]+r[e[n++]]}function s(e,t,n){var r=t&&n||0,o=t||[];e=e||{};var a=null!=e.clockseq?e.clockseq:_,u=null!=e.msecs?e.msecs:(new Date).getTime(),i=null!=e.nsecs?e.nsecs:x+1,s=u-T+(i-x)/1e4;if(0>s&&null==e.clockseq&&(a=a+1&16383),(0>s||u>T)&&null==e.nsecs&&(i=0),i>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");T=u,x=i,_=a,u+=122192928e5;var f=(1e4*(268435455&u)+i)%4294967296;o[r++]=f>>>24&255,o[r++]=f>>>16&255,o[r++]=f>>>8&255,o[r++]=255&f;var d=u/4294967296*1e4&268435455;o[r++]=d>>>8&255,o[r++]=255&d,o[r++]=d>>>24&15|16,o[r++]=d>>>16&255,o[r++]=a>>>8|128,o[r++]=255&a;for(var l=e.node||g,p=0;6>p;p++)o[r+p]=l[p];return t?t:c(o)}function f(e,t,n){var r=t&&n||0;"string"==typeof e&&(t="binary"===e?new m(16):null,e=null),e=e||{};var o=e.random||(e.rng||d)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,t)for(var a=0;16>a;a++)t[r+a]=o[a];return t||c(o)}var d,l,p,v;o?a():u();for(var m="function"==typeof Buffer?Buffer:Array,b=[],y={},w=0;256>w;w++)b[w]=(w+256).toString(16).substr(1),y[b[w]]=w;var h=d(),g=[1|h[0],h[1],h[2],h[3],h[4],h[5]],_=16383&(h[6]<<8|h[7]),T=0,x=0,I=f;I.v1=s,I.v4=f,I.parse=i,I.unparse=c,I.BufferClass=m,I._rng=d,I._mathRNG=l,I._nodeRNG=p,I._whatwgRNG=v,"undefined"!=typeof e&&e.exports?e.exports=I:(r=function(){return I}.call(t,n,t,e),!(void 0!==r&&(e.exports=r)))}("undefined"!=typeof window?window:null)},function(e,t){e.exports=require("crypto")},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e){var t=new p,n=(new Date).toISOString();Object.assign(t,e),t.id=s["default"].v4(),t.created=n,t.changed=n;var r={TableName:l,Item:t};return new Promise(function(e,n){d["default"].put(r,function(r,o){return r?n(r):e(t)})})}function u(e,t){return new Promise(function(n,r){var o={TableName:l,Key:{teamId:e,id:t}};d["default"].get(o,function(e,t){if(e)return r(e);var o=(0,f.fromDB)(p,t.Item);return n(o)})})}function i(e){return new Promise(function(t,n){var r={TableName:l,KeyConditionExpression:"teamId = :teamId",ExpressionAttributeValues:{":teamId":e}};d["default"].query(r,function(e,r){return e?n(e):t(r.Items.map(function(e){return(0,f.fromDB)(p,e)}))})})}Object.defineProperty(t,"__esModule",{value:!0}),t.Bot=void 0,t.createBot=a,t.getBot=u,t.getBots=i;var c=n(6),s=r(c),f=n(2),d=r(f),l=(0,f.resolveTableName)("bot-v1"),p=t.Bot=function v(){o(this,v)}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e){var t=e.botId,n=o(e,["botId"]),r=new b;Object.assign(r,n),r.id=l["default"].v4(),r.botId=t;var a=(new Date).toISOString();r.created=a,r.changed=a;var u={TableName:m,Item:r};return new Promise(function(e,t){v["default"].put(u,function(n,o){return n?t(n):e(r)})})}function i(e,t){var n={TableName:m,Key:{id:t,botId:e}};return new Promise(function(e,t){v["default"].get(n,function(n,r){if(n)return t(n);var o=void 0;return r.Item&&(o=(0,p.fromDB)(b,r.Item)),e(o)})})}function c(e){var t={TableName:m,KeyConditionExpression:"botId = :botId",ExpressionAttributeValues:{":botId":e}};return new Promise(function(e,n){v["default"].query(t,function(t,r){return t?n(t):e(r.Items.map(function(e){return(0,p.fromDB)(b,e)}))})})}function s(e,t){var n={TableName:m,Key:{id:t,botId:e},ReturnValues:"ALL_OLD"};return new Promise(function(e,t){v["default"]["delete"](n,function(n,r){return n?t(n):e((0,p.fromDB)(b,r.Attributes))})})}function f(e){var t=e.botId,n=e.id,r=e.title,o=e.body,a={TableName:m,Key:{id:n,botId:t},UpdateExpression:"\n      SET\n        #title = :title,\n        #body = :body,\n        #changed = :changed\n    ",ExpressionAttributeNames:{"#title":"title","#body":"body","#changed":"changed"},ExpressionAttributeValues:{":title":r,":body":o,":changed":(new Date).toISOString()},ReturnValues:"ALL_NEW"};return new Promise(function(e,t){v["default"].update(a,function(n,r){return n?t(n):e((0,p.fromDB)(b,r.Attributes))})})}Object.defineProperty(t,"__esModule",{value:!0}),t.Answer=void 0,t.createAnswer=u,t.getAnswer=i,t.getAnswers=c,t.deleteAnswer=s,t.updateAnswer=f;var d=n(6),l=r(d),p=n(2),v=r(p),m=(0,p.resolveTableName)("answer-v1"),b=t.Answer=function y(){a(this,y)}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){var n={TableName:p,Key:{id:t,userId:e}};return new Promise(function(e,t){l["default"].get(n,function(n,r){if(n)return t(n);var o=void 0;return r.Item&&(o=(0,d.fromDB)(v,r.Item)),e(o)})})}function i(e){var t=e.userId,n=o(e,["userId"]),r=new v,a=(new Date).toISOString();Object.assign(r,n),r.id=f["default"].v4(),r.userId=t,r.active=!0,r.created=a,r.changed=a;var u={TableName:p,Item:r};return new Promise(function(e,t){l["default"].put(u,function(n,o){return n?t(n):e(r)})})}function c(e,t){var n={TableName:p,Key:{id:e,userId:t}};return new Promise(function(e,t){l["default"]["delete"](n,function(n,r){return n?t(n):e()})})}Object.defineProperty(t,"__esModule",{value:!0}),t.Token=void 0,t.getToken=u,t.createToken=i,t.deleteToken=c;var s=n(6),f=r(s),d=n(2),l=r(d),p=(0,d.resolveTableName)("token-v1"),v=t.Token=function m(){a(this,m)}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(12);Object.defineProperty(t,"storage",{enumerable:!0,get:function(){return r(o)["default"]}})},function(e,t,n){"use strict";function r(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function r(o,a){try{var u=t[o](a),i=u.value}catch(c){return void n(c)}return u.done?void e(i):Promise.resolve(i).then(function(e){return r("next",e)},function(e){return r("throw",e)})}return r("next")})}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(4),a=n(5),u=n(8);t["default"]={teams:{get:function(){var e=r(regeneratorRuntime.mark(function t(e,n){var r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=void 0,t.prev=1,t.next=4,(0,o.getTeam)(e);case 4:r=t.sent,t.next=10;break;case 7:return t.prev=7,t.t0=t["catch"](1),t.abrupt("return",n(t.t0));case 10:return t.abrupt("return",n(null,r));case 11:case"end":return t.stop()}},t,void 0,[[1,7]])}));return function(t,n){return e.apply(this,arguments)}}(),save:function(){var e=r(regeneratorRuntime.mark(function t(e,n){var r,a=e.team,i=e.isnew;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=void 0,e.prev=1,e.next=4,(0,o.updateTeam)(a);case 4:r=e.sent,e.next=10;break;case 7:return e.prev=7,e.t0=e["catch"](1),e.abrupt("return",n(e.t0));case 10:if(!i){e.next=19;break}return e.prev=11,e.next=14,(0,u.createBot)({teamId:r.id});case 14:e.next=19;break;case 16:return e.prev=16,e.t1=e["catch"](11),e.abrupt("return",n(e.t1));case 19:return e.abrupt("return",n(null,r));case 20:case"end":return e.stop()}},t,void 0,[[1,7],[11,16]])}));return function(t,n){return e.apply(this,arguments)}}(),all:function(){var e=r(regeneratorRuntime.mark(function t(e){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=void 0,t.prev=1,t.next=4,(0,o.getTeams)();case 4:n=t.sent,t.next=10;break;case 7:return t.prev=7,t.t0=t["catch"](1),t.abrupt("return",e(t.t0));case 10:return t.abrupt("return",e(null,n));case 11:case"end":return t.stop()}},t,void 0,[[1,7]])}));return function(t){return e.apply(this,arguments)}}()},users:{get:function(){var e=r(regeneratorRuntime.mark(function t(e,n){var r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=void 0,t.prev=1,t.next=4,(0,a.getUser)(e);case 4:r=t.sent,t.next=10;break;case 7:return t.prev=7,t.t0=t["catch"](1),t.abrupt("return",n(t.t0));case 10:return t.abrupt("return",n(null,r));case 11:case"end":return t.stop()}},t,void 0,[[1,7]])}));return function(t,n){return e.apply(this,arguments)}}(),save:function(){var e=r(regeneratorRuntime.mark(function t(e,n){var r,o=e.user;e.isnew;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o.access_token&&(o.accessToken=o.access_token,delete o.access_token),o.team_id&&(o.teamId=o.team_id,delete o.team_id),r=void 0,e.prev=3,e.next=6,(0,a.updateUser)(o);case 6:r=e.sent,e.next=12;break;case 9:return e.prev=9,e.t0=e["catch"](3),e.abrupt("return",n(e.t0));case 12:return e.abrupt("return",n(null,r));case 13:case"end":return e.stop()}},t,void 0,[[3,9]])}));return function(t,n){return e.apply(this,arguments)}}(),all:function(e){return e(new Error("Not implemented"))}},channels:{get:function(e,t){return t(new Error("Not implemented"))},save:function(e,t){return t(new Error("Not implemented"))},all:function(e){return e(new Error("Not implemented"))}}}}])});
//# sourceMappingURL=index.min.js.map
